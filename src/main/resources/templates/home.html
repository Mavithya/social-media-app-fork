<!DOCTYPE html>
<html lang="en" data-theme="dark"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/extras/spring-security6">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SocialHub - Home</title>
  <link th:href="@{/css/main.css}" rel="stylesheet"/>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@3.9.4/dist/full.css" rel="stylesheet" type="text/css" />
</head>
<body class="animate-gradient-ocean text-white">
<div th:replace="components/navbar :: navbar"></div>
<div class="flex max-w-7xl mx-auto">
  <div th:replace="components/profile-sidebar :: profileSidebar"></div>
  <div th:replace="components/feed :: feed"></div>
  <div th:replace="components/right-sidebar :: rightSidebar"></div>
</div>
<div th:replace="components/mobile-navbar :: mobileNavbar"></div>

<!-- Profile Settings Modal -->
<div id="profileSettingsModal" class="fixed inset-0 z-50 hidden bg-black bg-opacity-60 flex items-center justify-center">
  <div class="bg-gray-900 rounded-2xl p-8 shadow-2xl w-full max-w-2xl relative">
    <button onclick="closeProfileSettingsModal()" class="absolute top-4 right-4 text-white text-xl">&times;</button>
    <h1 class="text-3xl font-bold text-brand-400 mb-6">Edit Profile</h1>

    <form th:action="@{/profile/update}" method="post" class="space-y-4">
      <div>
        <label class="block text-sm font-semibold mb-1">First Name</label>
        <input type="text" name="firstName" class="input input-bordered w-full bg-gray-800 border-gray-700 text-white" placeholder="Anujaya" required>
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Last Name</label>
        <input type="text" name="lastName" class="input input-bordered w-full bg-gray-800 border-gray-700 text-white" placeholder="Perera" required>
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Email</label>
        <input type="email" name="email" class="input input-bordered w-full bg-gray-800 border-gray-700 text-white" placeholder="you@example.com" required>
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Password</label>
        <input type="password" name="password" class="input input-bordered w-full bg-gray-800 border-gray-700 text-white" placeholder="••••••••" required>
      </div>
      <button type="submit" class="btn btn-primary mt-4 w-full">Save Changes</button>
    </form>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const textarea = document.querySelector('textarea');
    const charCounter = document.querySelector('.text-xs.text-gray-400');
    if (textarea && charCounter) {
      textarea.addEventListener('input', function() {
        const count = this.value.length;
        charCounter.textContent = count + '/280 characters';
        if (count > 280) {
          charCounter.classList.add('text-red-400');
          charCounter.classList.remove('text-gray-400');
        } else {
          charCounter.classList.add('text-gray-400');
          charCounter.classList.remove('text-red-400');
        }
      });
    }

    const likeButtons = document.querySelectorAll('.btn-ghost:has(svg)');
    likeButtons.forEach(button => {
      if (button.textContent.trim().match(/^\d+$/)) {
        button.addEventListener('click', function() {
          const heartSvg = this.querySelector('svg');
          if (heartSvg && heartSvg.classList.contains('fill-red-400')) {
            heartSvg.classList.remove('fill-red-400');
            this.classList.remove('text-red-400');
            this.classList.add('text-gray-400');
          } else if (heartSvg) {
            heartSvg.classList.add('fill-red-400');
            this.classList.add('text-red-400');
            this.classList.remove('text-gray-400');
          }
        });
      }
    });
  });

  function openProfileSettingsModal() {
    document.getElementById('profileSettingsModal').classList.remove('hidden');
  }

  function closeProfileSettingsModal() {
    document.getElementById('profileSettingsModal').classList.add('hidden');
  }
</script>
</body>
</html>